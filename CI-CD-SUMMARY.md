# ğŸš€ CI/CD å®Œæ•´é…ç½®æ€»ç»“

## âœ… å·²å®Œæˆçš„é…ç½®æ–‡ä»¶

### 1. GitHub Actionså·¥ä½œæµ
- ğŸ“„ `.github/workflows/ci-cd.yml` - å®Œæ•´çš„CI/CDæµæ°´çº¿
- ğŸ”„ æ”¯æŒè‡ªåŠ¨æµ‹è¯•ã€æ„å»ºã€éƒ¨ç½²åˆ°æµ‹è¯•å’Œç”Ÿäº§ç¯å¢ƒ

### 2. Dockeré…ç½®
- ğŸ“„ `Dockerfile` - å¼€å‘ç¯å¢ƒDockeré…ç½® (å·²æ›´æ–°ä¸ºPython 3.9 + æœ€å°åŒ–ä¾èµ–)
- ğŸ“„ `Dockerfile.production` - ç”Ÿäº§ç¯å¢ƒDockeré…ç½®
- ğŸ“„ `docker-compose.production.yml` - ç”Ÿäº§ç¯å¢ƒç¼–æ’é…ç½®
- ğŸ“„ `.dockerignore` - Dockeræ„å»ºå¿½ç•¥æ–‡ä»¶

### 3. éƒ¨ç½²è„šæœ¬
- ğŸ“„ `setup-github-secrets.sh` - GitHub Secretsè‡ªåŠ¨é…ç½®è„šæœ¬
- ğŸ“„ `server-init.sh` - æœåŠ¡å™¨ç¯å¢ƒåˆå§‹åŒ–è„šæœ¬  
- ğŸ“„ `push-and-deploy.sh` - å¿«é€Ÿæ¨é€å’Œéƒ¨ç½²è„šæœ¬

### 4. æ–‡æ¡£
- ğŸ“„ `CI-CD-GUIDE.md` - è¯¦ç»†çš„CI/CDéƒ¨ç½²æŒ‡å—
- ğŸ“„ `requirements_minimal_fixed.txt` - æœ€å°åŒ–ä¾èµ–æ–‡ä»¶ (å·²éªŒè¯å¯ç”¨)

## ğŸ—ï¸ æœåŠ¡å™¨ä¿¡æ¯

### 1. ç”Ÿäº§æœåŠ¡å™¨
- **IP**: 47.94.225.76
- **ç”¨æˆ·**: root
- **å¯†ç **: [æ‚¨çš„ç”Ÿäº§æœåŠ¡å™¨å¯†ç ]
- **ç«¯å£**: 22
- **åº”ç”¨åœ°å€**: http://47.94.225.76:8501

### 2. æµ‹è¯•æœåŠ¡å™¨
- **IP**: 192.168.2.8
- **ç”¨æˆ·**: root
- **å¯†ç **: [æ‚¨çš„æµ‹è¯•æœåŠ¡å™¨å¯†ç ]

## ğŸ³ Docker Hub

### é•œåƒä¿¡æ¯
- **ç”¨æˆ·å**: tuoyongjun1987
- **é•œåƒå**: tuoyongjun1987/gupiao-stock-analysis
- **è®¿é—®ä»¤ç‰Œ**: [è®¾ç½®ä¸ºGitHub Secret]

### ç™»å½•å‘½ä»¤
```bash
docker login -u tuoyongjun1987
# å¯†ç : [ä½¿ç”¨GitHub Secretä¸­çš„DOCKER_HUB_TOKEN]
```

## ğŸ“‹ GitHubé…ç½®

### ä»“åº“ä¿¡æ¯
- **ç”¨æˆ·å**: tyj1987
- **é‚®ç®±**: tuoyongjun1987@qq.com
- **ä»“åº“**: https://github.com/tyj1987/gupiao

### å¿…éœ€çš„Secrets
- `DOCKER_HUB_TOKEN`: [Docker Hubè®¿é—®ä»¤ç‰Œ]
- `TEST_SERVER_PASSWORD`: [æµ‹è¯•æœåŠ¡å™¨å¯†ç ]  
- `PROD_SERVER_PASSWORD`: [ç”Ÿäº§æœåŠ¡å™¨å¯†ç ]

## ğŸš€ å¿«é€Ÿéƒ¨ç½²æ­¥éª¤

### 1. é…ç½®GitHub Secrets
```bash
./setup-github-secrets.sh
```

### 2. åˆå§‹åŒ–æœåŠ¡å™¨
åœ¨æ¯å°æœåŠ¡å™¨ä¸Šè¿è¡Œï¼š
```bash
curl -fsSL https://raw.githubusercontent.com/tyj1987/gupiao/main/server-init.sh | bash
```

### 3. æ¨é€ä»£ç è§¦å‘éƒ¨ç½²
```bash
./push-and-deploy.sh "æ›´æ–°CI/CDé…ç½®"
```

## ğŸ”„ CI/CDæµç¨‹

### è§¦å‘æ¡ä»¶
- æ¨é€åˆ° `main` åˆ†æ”¯
- åˆ›å»ºPRåˆ° `main` åˆ†æ”¯

### æ‰§è¡Œæµç¨‹
1. **æµ‹è¯•é˜¶æ®µ** - Pythonç¯å¢ƒå’Œä¾èµ–æµ‹è¯•
2. **æ„å»ºé˜¶æ®µ** - Dockeré•œåƒæ„å»ºå’Œæ¨é€
3. **æµ‹è¯•éƒ¨ç½²** - éƒ¨ç½²åˆ°æµ‹è¯•æœåŠ¡å™¨éªŒè¯
4. **ç”Ÿäº§éƒ¨ç½²** - éƒ¨ç½²åˆ°ç”Ÿäº§æœåŠ¡å™¨
5. **é€šçŸ¥é˜¶æ®µ** - å‘é€éƒ¨ç½²ç»“æœ

### éƒ¨ç½²æ—¶é—´
- æ€»æµç¨‹çº¦ 10-15 åˆ†é’Ÿ
- é•œåƒæ„å»ºçº¦ 5-8 åˆ†é’Ÿ
- æœåŠ¡å™¨éƒ¨ç½²çº¦ 2-3 åˆ†é’Ÿ

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### å¥åº·æ£€æŸ¥
- åº”ç”¨æä¾› `/healthz` ç«¯ç‚¹
- Dockerè‡ªåŠ¨å¥åº·æ£€æŸ¥
- CI/CDæµç¨‹åŒ…å«éƒ¨ç½²éªŒè¯

### æ—¥å¿—æŸ¥çœ‹
```bash
# å®¹å™¨æ—¥å¿—
docker logs gupiao-app

# åº”ç”¨æ—¥å¿—
docker exec gupiao-app tail -f /app/logs/app.log
```

### æ‰‹åŠ¨é‡å¯
```bash
# é‡å¯å®¹å™¨
docker restart gupiao-app

# æ›´æ–°éƒ¨ç½²
docker pull tuoyongjun1987/gupiao-stock-analysis:latest
docker stop gupiao-app && docker rm gupiao-app
docker run -d --name gupiao-app --restart unless-stopped -p 8501:8501 tuoyongjun1987/gupiao-stock-analysis:latest
```

## âœ¨ ç‰¹æ€§ä¼˜åŠ¿

### ğŸ”§ è‡ªåŠ¨åŒ–ç¨‹åº¦é«˜
- ä»£ç æ¨é€è‡ªåŠ¨è§¦å‘éƒ¨ç½²
- è‡ªåŠ¨å¥åº·æ£€æŸ¥å’Œå›æ»š
- è‡ªåŠ¨é•œåƒæ„å»ºå’Œæ¨é€

### ğŸƒâ€â™‚ï¸ éƒ¨ç½²å¿«é€Ÿ
- ä½¿ç”¨æœ€å°åŒ–ä¾èµ–å‡å°‘æ„å»ºæ—¶é—´
- Dockerå±‚ç¼“å­˜ä¼˜åŒ–
- å¹¶è¡Œéƒ¨ç½²åˆ°å¤šç¯å¢ƒ

### ğŸ”’ å®‰å…¨å¯é 
- æ•æ„Ÿä¿¡æ¯ä½¿ç”¨GitHub Secrets
- æœåŠ¡å™¨é˜²ç«å¢™é…ç½®
- å®¹å™¨å¥åº·æ£€æŸ¥

### ğŸ“ˆ æ˜“äºç»´æŠ¤
- å®Œæ•´çš„éƒ¨ç½²æ–‡æ¡£
- è‡ªåŠ¨åŒ–è„šæœ¬
- ç»Ÿä¸€çš„ç¯å¢ƒé…ç½®

## ğŸ¯ ä¸‹ä¸€æ­¥

### ç«‹å³æ‰§è¡Œ
1. è¿è¡Œ `./setup-github-secrets.sh` é…ç½®Secrets
2. åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œ `server-init.sh` åˆå§‹åŒ–ç¯å¢ƒ
3. è¿è¡Œ `./push-and-deploy.sh` æ¨é€ä»£ç å¹¶è‡ªåŠ¨éƒ¨ç½²

### è®¿é—®åº”ç”¨
éƒ¨ç½²å®Œæˆåè®¿é—®ï¼š
- ğŸ§ª æµ‹è¯•ç¯å¢ƒ: http://192.168.2.8:8501
- ğŸŒ ç”Ÿäº§ç¯å¢ƒ: http://47.94.225.76:8501

---

**é…ç½®å®Œæˆï¼æ‚¨çš„è‚¡ç¥¨åˆ†æç³»ç»Ÿç°åœ¨å…·å¤‡äº†å®Œæ•´çš„CI/CDèƒ½åŠ›ï¼** ğŸ‰
