# ğŸ³ Dockeréƒ¨ç½²æ€»ç»“

## ğŸ“¦ Dockeréƒ¨ç½²æ–‡ä»¶æ¸…å•

### æ ¸å¿ƒDockeræ–‡ä»¶
- âœ… `Dockerfile` - Dockeré•œåƒæ„å»ºæ–‡ä»¶
- âœ… `docker-compose.yml` - å®Œæ•´ç‰ˆå®¹å™¨ç¼–æ’ï¼ˆåŒ…å«Nginx+Redisï¼‰
- âœ… `docker-compose.simple.yml` - ç®€åŒ–ç‰ˆå®¹å™¨ç¼–æ’ï¼ˆä»…ä¸»æœåŠ¡ï¼‰
- âœ… `.dockerignore` - Dockeræ„å»ºå¿½ç•¥æ–‡ä»¶
- âœ… `nginx.conf` - Nginxåå‘ä»£ç†é…ç½®

### ç®¡ç†è„šæœ¬
- âœ… `docker-manage.sh` - å®Œæ•´çš„Dockerç®¡ç†å·¥å…·
- âœ… `docker-quick-deploy.sh` - å¿«é€Ÿéƒ¨ç½²è„šæœ¬

### éƒ¨ç½²æ–‡æ¡£
- âœ… `DOCKER_DEPLOYMENT_GUIDE.md` - è¯¦ç»†çš„Dockeréƒ¨ç½²æŒ‡å—

---

## ğŸš€ ä¸‰ç§éƒ¨ç½²æ–¹å¼

### æ–¹å¼ä¸€ï¼šå¿«é€Ÿéƒ¨ç½²ï¼ˆæ¨èæ–°æ‰‹ï¼‰
```bash
# ä¸€é”®å¿«é€Ÿéƒ¨ç½²
chmod +x docker-quick-deploy.sh
./docker-quick-deploy.sh
```

### æ–¹å¼äºŒï¼šå®Œæ•´éƒ¨ç½²ï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒï¼‰
```bash
# ä½¿ç”¨ç®¡ç†è„šæœ¬
chmod +x docker-manage.sh
./docker-manage.sh up
```

### æ–¹å¼ä¸‰ï¼šæ‰‹åŠ¨éƒ¨ç½²ï¼ˆæ¨èæœ‰ç»éªŒç”¨æˆ·ï¼‰
```bash
# é…ç½®APIå¯†é’¥
cp config/api_keys.example.py config/api_keys.py
vim config/api_keys.py

# æ„å»ºå’Œå¯åŠ¨
docker-compose build
docker-compose up -d
```

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### ç®€åŒ–ç‰ˆæ¶æ„ï¼ˆdocker-compose.simple.ymlï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è‚¡ç¥¨åˆ†æç³»ç»Ÿ    â”‚
â”‚  (Streamlit)    â”‚
â”‚   Port: 8501    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å®Œæ•´ç‰ˆæ¶æ„ï¼ˆdocker-compose.ymlï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Nginx    â”‚    â”‚   è‚¡ç¥¨åˆ†æç³»ç»Ÿ    â”‚    â”‚    Redis    â”‚
â”‚ (åå‘ä»£ç†)   â”‚â”€â”€â”€â–¶â”‚  (Streamlit)    â”‚â”€â”€â”€â–¶â”‚   (ç¼“å­˜)    â”‚
â”‚ Port: 80/443â”‚    â”‚   Port: 8501    â”‚    â”‚ Port: 6379  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ ç®¡ç†å‘½ä»¤é€ŸæŸ¥

### åŸºç¡€æ“ä½œ
```bash
# å¯åŠ¨æœåŠ¡
docker-compose up -d

# åœæ­¢æœåŠ¡
docker-compose down

# é‡å¯æœåŠ¡
docker-compose restart

# æŸ¥çœ‹çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

### é«˜çº§ç®¡ç†
```bash
# ä½¿ç”¨ç®¡ç†è„šæœ¬
./docker-manage.sh status    # æŸ¥çœ‹çŠ¶æ€
./docker-manage.sh logs      # æŸ¥çœ‹æ—¥å¿—
./docker-manage.sh shell     # è¿›å…¥å®¹å™¨
./docker-manage.sh backup    # å¤‡ä»½æ•°æ®
./docker-manage.sh update    # æ›´æ–°æœåŠ¡
```

---

## ğŸ“Š ç³»ç»Ÿç‰¹æ€§

### ğŸ¯ åŠŸèƒ½ç‰¹æ€§
- âœ… **5,728åªè‚¡ç¥¨** - å…¨å¸‚åœºè¦†ç›–ï¼ˆAè‚¡+æ¸¯è‚¡+ç¾è‚¡ï¼‰
- âœ… **æ™ºèƒ½æœç´¢** - æ”¯æŒåç§°ã€ä»£ç ã€æ‹¼éŸ³æœç´¢
- âœ… **å®æ—¶é£é™©è¯„ä¼°** - å¤šç»´åº¦é£é™©åˆ†æ
- âœ… **Webç•Œé¢** - ç°ä»£åŒ–Streamlitç•Œé¢

### ğŸ³ Dockerä¼˜åŠ¿
- âœ… **ç¯å¢ƒä¸€è‡´æ€§** - å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒå®Œå…¨ä¸€è‡´
- âœ… **å¿«é€Ÿéƒ¨ç½²** - 5åˆ†é’Ÿå†…å®Œæˆéƒ¨ç½²
- âœ… **æ˜“äºç®¡ç†** - å®¹å™¨åŒ–ç®¡ç†ï¼Œæ”¯æŒä¸€é”®å¯åœ
- âœ… **èµ„æºéš”ç¦»** - ç‹¬ç«‹çš„è¿è¡Œç¯å¢ƒ
- âœ… **æ¨ªå‘æ‰©å±•** - æ”¯æŒå¤šå®ä¾‹éƒ¨ç½²

---

## ğŸ”’ å®‰å…¨é…ç½®

### åŸºç¡€å®‰å…¨
```bash
# é˜²ç«å¢™é…ç½®
sudo firewall-cmd --permanent --add-port=8501/tcp
sudo firewall-cmd --reload

# å®¹å™¨ç”¨æˆ·æƒé™
docker-compose.yml:
  user: "1000:1000"  # érootç”¨æˆ·
```

### é«˜çº§å®‰å…¨
```bash
# SSLè¯ä¹¦é…ç½®
mkdir ssl/
# å°†è¯ä¹¦æ–‡ä»¶æ”¾å…¥sslç›®å½•
# ç¼–è¾‘nginx.confå¯ç”¨HTTPS
```

---

## ğŸ“ˆ æ€§èƒ½è°ƒä¼˜

### èµ„æºé™åˆ¶
```yaml
services:
  gupiao:
    deploy:
      resources:
        limits:
          memory: 2G
          cpus: '1.0'
```

### ç¼“å­˜ä¼˜åŒ–
```yaml
volumes:
  gupiao_cache:
    driver: local
    driver_opts:
      type: tmpfs  # ä½¿ç”¨å†…å­˜ç¼“å­˜
      device: tmpfs
```

---

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜
1. **ç«¯å£å ç”¨**: ä¿®æ”¹docker-compose.ymlä¸­çš„ç«¯å£æ˜ å°„
2. **å†…å­˜ä¸è¶³**: å¢åŠ ç³»ç»Ÿå†…å­˜æˆ–é™åˆ¶å®¹å™¨å†…å­˜ä½¿ç”¨
3. **ç£ç›˜ç©ºé—´**: å®šæœŸæ¸…ç†Dockerèµ„æº
4. **ç½‘ç»œé—®é¢˜**: æ£€æŸ¥é˜²ç«å¢™å’Œç½‘ç»œé…ç½®

### è°ƒè¯•å‘½ä»¤
```bash
# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker-compose logs gupiao

# è¿›å…¥å®¹å™¨è°ƒè¯•
docker-compose exec gupiao /bin/bash

# æŸ¥çœ‹èµ„æºä½¿ç”¨
docker stats

# æ¸…ç†ç³»ç»Ÿ
docker system prune -a
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### æ—¥å¿—ä½ç½®
- åº”ç”¨æ—¥å¿—: `docker-compose logs gupiao`
- å®¹å™¨çŠ¶æ€: `docker-compose ps`
- ç³»ç»Ÿèµ„æº: `docker stats`

### é…ç½®æ–‡ä»¶
- Dockeré…ç½®: `docker-compose.yml`
- åº”ç”¨é…ç½®: `config/api_keys.py`
- Nginxé…ç½®: `nginx.conf`

---

## ğŸ¯ ç”Ÿäº§ç¯å¢ƒå»ºè®®

### 1. ä½¿ç”¨å®Œæ•´ç‰ˆéƒ¨ç½²
```bash
# æ¨èä½¿ç”¨åŒ…å«Nginxå’ŒRedisçš„å®Œæ•´ç‰ˆ
docker-compose -f docker-compose.yml up -d
```

### 2. é…ç½®æŒä¹…åŒ–å­˜å‚¨
```bash
# ç¡®ä¿æ•°æ®æŒä¹…åŒ–
volumes:
  gupiao_cache:
    driver: local
    driver_opts:
      o: bind
      type: none
      device: /data/gupiao/cache
```

### 3. ç›‘æ§å’Œå‘Šè­¦
```bash
# é›†æˆç›‘æ§å·¥å…·
- Prometheus + Grafana
- ELK Stack (æ—¥å¿—åˆ†æ)
- Docker Health Checks
```

### 4. å¤‡ä»½ç­–ç•¥
```bash
# å®šæœŸå¤‡ä»½
./docker-manage.sh backup

# è‡ªåŠ¨åŒ–å¤‡ä»½ï¼ˆcrontabï¼‰
0 2 * * * /path/to/docker-manage.sh backup
```

---

**ğŸ‰ æ­å–œï¼æ‚¨ç°åœ¨æ‹¥æœ‰äº†å®Œæ•´çš„Dockeréƒ¨ç½²æ–¹æ¡ˆï¼**

## ğŸ“‹ éƒ¨ç½²æ—¶é—´å¯¹æ¯”

| éƒ¨ç½²æ–¹å¼ | æ—¶é—´ | å¤æ‚åº¦ | é€‚ç”¨åœºæ™¯ |
|---------|------|--------|----------|
| å¿«é€Ÿéƒ¨ç½² | 5åˆ†é’Ÿ | ç®€å• | å¼€å‘æµ‹è¯• |
| ä¼ ç»Ÿéƒ¨ç½² | 25åˆ†é’Ÿ | ä¸­ç­‰ | ç”Ÿäº§ç¯å¢ƒ |
| Dockeréƒ¨ç½² | 10åˆ†é’Ÿ | ç®€å• | æ‰€æœ‰åœºæ™¯ |

é€‰æ‹©é€‚åˆæ‚¨çš„éƒ¨ç½²æ–¹å¼ï¼Œå¼€å§‹ä½“éªŒ5,728åªè‚¡ç¥¨çš„å¼ºå¤§åˆ†æèƒ½åŠ›ï¼ğŸš€
