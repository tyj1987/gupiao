#!/usr/bin/env python3
"""
完整的中国A股股票池
包含主要的蓝筹股、行业龙头、央企国企等
"""

from typing import Dict, List, Optional
from loguru import logger

class ComprehensiveStockPool:
    """完整的A股股票池"""
    
    def __init__(self):
        self.comprehensive_mapping = self._init_comprehensive_mapping()
        self.industry_mapping = self._init_industry_mapping()
    
    def _init_comprehensive_mapping(self) -> Dict[str, str]:
        """初始化完整的股票映射表"""
        return {
            # === 石油化工行业 ===
            '601857.SH': '中国石油',    # 中石油
            '600028.SH': '中国石化',    # 中石化
            '600688.SH': '上海石化',
            '600871.SH': '石化油服',
            '002493.SZ': '荣盛石化',
            '000703.SZ': '恒逸石化',
            '000059.SZ': '华锦股份',
            '600346.SH': '恒力石化',
            '000301.SZ': '东方盛虹',
            '002648.SZ': '卫星石化',
            
            # === 银行股（完整） ===
            '601398.SH': '工商银行',
            '601988.SH': '中国银行',
            '601939.SH': '建设银行',
            '601288.SH': '农业银行',
            '600036.SH': '招商银行',
            '000001.SZ': '平安银行',
            '600000.SH': '浦发银行',
            '601328.SH': '交通银行',
            '600015.SH': '华夏银行',
            '600016.SH': '民生银行',
            '601169.SH': '北京银行',
            '002142.SZ': '宁波银行',
            '601009.SH': '南京银行',
            '600919.SH': '江苏银行',
            '601229.SH': '上海银行',
            '002839.SZ': '张家港行',
            '600926.SH': '杭州银行',
            '002958.SZ': '青农商行',
            '601838.SH': '成都银行',
            '601916.SH': '浙商银行',
            '002966.SZ': '苏州银行',
            '601577.SH': '长沙银行',
            '600908.SH': '无锡银行',
            '002807.SZ': '江阴银行',
            '600323.SH': '瀚叶股份',
            
            # === 保险证券 ===
            '601318.SH': '中国平安',
            '601601.SH': '中国太保',
            '601628.SH': '中国人寿',
            '002142.SZ': '宁波银行',
            '000776.SZ': '广发证券',
            '600030.SH': '中信证券',
            '000166.SZ': '申万宏源',
            '600837.SH': '海通证券',
            '600958.SH': '东方证券',
            '000783.SZ': '长江证券',
            '002736.SZ': '国信证券',
            '601788.SH': '光大证券',
            '600999.SH': '招商证券',
            '000728.SZ': '国元证券',
            
            # === 白酒股（完整） ===
            '600519.SH': '贵州茅台',
            '000858.SZ': '五粮液',
            '000568.SZ': '泸州老窖',
            '002304.SZ': '洋河股份',
            '000596.SZ': '古井贡酒',
            '603589.SH': '口子窖',
            '000799.SZ': '酒鬼酒',
            '600779.SH': '水井坊',
            '603919.SH': '金徽酒',
            '600702.SH': '舍得酒业',
            '000860.SZ': '顺鑫农业',
            '600809.SH': '山西汾酒',
            '600132.SH': '重庆啤酒',
            '000729.SZ': '燕京啤酒',
            '600600.SH': '青岛啤酒',
            
            # === 房地产行业 ===
            '000002.SZ': '万科A',
            '001979.SZ': '招商蛇口',
            '600048.SH': '保利发展',
            '000069.SZ': '华侨城A',
            '600340.SH': '华夏幸福',
            '600383.SH': '金地集团',
            '001289.SZ': '建发股份',
            '600266.SH': '北京城建',
            '000736.SZ': '中交地产',
            '600663.SH': '陆家嘴',
            '000656.SZ': '金科股份',
            '000979.SZ': '中弘股份',
            '600177.SH': '雅戈尔',
            '000961.SZ': '中南建设',
            '000402.SZ': '金融街',
            
            # === 钢铁有色 ===
            '600019.SH': '宝钢股份',
            '000709.SZ': '河钢股份',
            '600581.SH': '八一钢铁',
            '000932.SZ': '华菱钢铁',
            '600569.SH': '安阳钢铁',
            '000825.SZ': '太钢不锈',
            '002110.SZ': '三钢闽光',
            '000898.SZ': '鞍钢股份',
            '600010.SH': '包钢股份',
            '002318.SZ': '久立特材',
            '600362.SH': '江西铜业',
            '002460.SZ': '赣锋锂业',
            '002466.SZ': '天齐锂业',
            '000831.SZ': '五矿稀土',
            '600111.SH': '北方稀土',
            '002716.SZ': '金贵银业',
            '600549.SH': '厦门钨业',
            '000060.SZ': '中金岭南',
            '002476.SZ': '宝莫股份',
            '600489.SH': '中金黄金',
            
            # === 煤炭电力 ===
            '601088.SH': '中国神华',
            '600188.SH': '兖州煤业',
            '601001.SH': '大同煤业',
            '600348.SH': '阳泉煤业',
            '600395.SH': '盘江股份',
            '600508.SH': '上海能源',
            '601666.SH': '平煤股份',
            '600123.SH': '兰花科创',
            '000983.SZ': '西山煤电',
            '002128.SZ': '露天煤业',
            '600886.SH': '国投电力',
            '000875.SZ': '吉电股份',
            '600027.SH': '华电国际',
            '600795.SH': '国电电力',
            '000531.SZ': '穗恒运A',
            '600900.SH': '长江电力',
            '000001.SZ': '平安银行',
            '601985.SH': '中国核电',
            '600905.SH': '三峡能源',
            
            # === 科技股（完整） ===
            '000063.SZ': '中兴通讯',
            '002415.SZ': '海康威视',
            '300059.SZ': '东方财富',
            '002230.SZ': '科大讯飞',
            '000725.SZ': '京东方A',
            '002241.SZ': '歌尔股份',
            '300750.SZ': '宁德时代',
            '002142.SZ': '宁波银行',
            '000938.SZ': '紫光股份',
            '002049.SZ': '紫光国微',
            '002065.SZ': '东华软件',
            '002474.SZ': '榕基软件',
            '300033.SZ': '同花顺',
            '300454.SZ': '深信服',
            '002153.SZ': '石基信息',
            '002405.SZ': '四维图新',
            '300017.SZ': '网宿科技',
            '002052.SZ': '同洲电子',
            '300002.SZ': '神州泰岳',
            '300253.SZ': '卫宁健康',
            
            # === 新能源汽车 ===
            '002594.SZ': '比亚迪',
            '600104.SH': '上汽集团',
            '000625.SZ': '长安汽车',
            '601238.SH': '广汽集团',
            '000800.SZ': '一汽解放',
            '000550.SZ': '江铃汽车',
            '600066.SH': '宇通客车',
            '002129.SZ': '中环股份',
            '601012.SH': '隆基绿能',
            '300274.SZ': '阳光电源',
            '002459.SZ': '晶澳科技',
            '300763.SZ': '锦浪科技',
            '300014.SZ': '亿纬锂能',
            '300450.SZ': '先导智能',
            '002709.SZ': '天赐材料',
            '300073.SZ': '当升科技',
            '002497.SZ': '雅化集团',
            
            # === 医药生物 ===
            '000661.SZ': '长春高新',
            '600276.SH': '恒瑞医药',
            '300015.SZ': '爱尔眼科',
            '000423.SZ': '东阿阿胶',
            '603259.SH': '药明康德',
            '300347.SZ': '泰格医药',
            '300760.SZ': '迈瑞医疗',
            '600521.SH': '华海药业',
            '002821.SZ': '凯莱英',
            '300601.SZ': '康泰生物',
            '600332.SH': '白云山',
            '000538.SZ': '云南白药',
            '002007.SZ': '华兰生物',
            '300142.SZ': '沃森生物',
            '600161.SH': '天坛生物',
            '000078.SZ': '海王生物',
            '002422.SZ': '科伦药业',
            '002252.SZ': '上海莱士',
            '000999.SZ': '华润三九',
            '600285.SH': '羚锐制药',
            
            # === 消费股（完整） ===
            '000895.SZ': '双汇发展',
            '002032.SZ': '苏泊尔',
            '600887.SH': '伊利股份',
            '002568.SZ': '百润股份',
            '603288.SH': '海天味业',
            '000333.SZ': '美的集团',
            '000651.SZ': '格力电器',
            '600298.SH': '安琪酵母',
            '000876.SZ': '新希望',
            '000895.SZ': '双汇发展',
            '002714.SZ': '牧原股份',
            '000858.SZ': '五粮液',
            '603369.SH': '今世缘',
            '002304.SZ': '洋河股份',
            '600600.SH': '青岛啤酒',
            '600132.SH': '重庆啤酒',
            '000729.SZ': '燕京啤酒',
            '600519.SH': '贵州茅台',
            '000568.SZ': '泸州老窖',
            '600779.SH': '水井坊',
            
            # === 交通运输 ===
            '600029.SH': '南方航空',
            '600115.SH': '东方航空',
            '601111.SH': '中国国航',
            '600026.SH': '中远海能',
            '601919.SH': '中远海控',
            '600428.SH': '中远海发',
            '601618.SH': '中国中冶',
            '600320.SH': '振华重工',
            '000089.SZ': '深圳机场',
            '600004.SH': '白云机场',
            '600009.SH': '上海机场',
            '000063.SZ': '中兴通讯',
            '601006.SH': '大秦铁路',
            '000528.SZ': '柳工',
            '000157.SZ': '中联重科',
            '000425.SZ': '徐工机械',
            '600031.SH': '三一重工',
            
            # === 建筑材料 ===
            '600585.SH': '海螺水泥',
            '000877.SZ': '天山股份',
            '600801.SH': '华新水泥',
            '002233.SZ': '塔牌集团',
            '600720.SH': '祁连山',
            '000401.SZ': '冀东水泥',
            '000789.SZ': '万年青',
            '000758.SZ': '中色股份',
            '000885.SZ': '同力水泥',
            '600318.SH': '巢东股份',
            '000786.SZ': '北新建材',
            '002043.SZ': '兔宝宝',
            '000407.SZ': '胜利股份',
            '600176.SH': '中国巨石',
            '002080.SZ': '中材科技',
            
            # === 通信行业 ===
            '600050.SH': '中国联通',
            '000063.SZ': '中兴通讯',
            '600776.SH': '东方通信',
            '002017.SZ': '东信和平',
            '000070.SZ': '特发信息',
            '600498.SH': '烽火通信',
            '002396.SZ': '星网锐捷',
            '002281.SZ': '光迅科技',
            '300136.SZ': '信维通信',
            '002093.SZ': '国脉科技',
            '300025.SZ': '华星创业',
            '300081.SZ': '恒信移动',
            '002056.SZ': '横店东磁',
            '600487.SH': '亨通光电',
            '000008.SZ': '神州高铁',
            
            # === 军工航天 ===
            '000768.SZ': '中航飞机',
            '600893.SH': '航发动力',
            '002013.SZ': '中航机电',
            '000738.SZ': '航发控制',
            '002151.SZ': '北斗星通',
            '002465.SZ': '海格通信',
            '000901.SZ': '航天科技',
            '600879.SH': '航天电子',
            '002025.SZ': '航天电器',
            '000687.SZ': '华讯方舟',
            '600855.SH': '航天长峰',
            '000547.SZ': '航天发展',
            '600343.SH': '航天动力',
            '002268.SZ': '卫士通',
            '600990.SH': '四创电子',
            
            # === 央企国企（重要补充） ===
            '601390.SH': '中国中铁',
            '601186.SH': '中国铁建',
            '601800.SH': '中国交建',
            '601668.SH': '中国建筑',
            '600068.SH': '葛洲坝',
            '002186.SZ': '全聚德',
            '600583.SH': '海油工程',
            '601808.SH': '中海油服',
            '000983.SZ': '西山煤电',
            '600508.SH': '上海能源',
            '600348.SH': '阳泉煤业',
            '601001.SH': '大同煤业',
            '601666.SH': '平煤股份',
            '600123.SH': '兰花科创',
            '000983.SZ': '西山煤电',
            
            # === 港股通重要标的 ===
            '00700.HK': '腾讯控股',
            '09988.HK': '阿里巴巴-SW',
            '01299.HK': '友邦保险',
            '03690.HK': '美团-W',
            '02318.HK': '中国平安',
            '01398.HK': '工商银行',
            '03988.HK': '中国银行',
            '00939.HK': '建设银行',
            '01288.HK': '农业银行',
            '00883.HK': '中国海洋石油',
            '00857.HK': '中国石油股份',
            '00386.HK': '中国石油化工股份',
            '02628.HK': '中国人寿',
            '01088.HK': '中国神华',
            '00728.HK': '中国电信',
            '00762.HK': '中国联通',
            '00941.HK': '中国移动',
            
            # === 科创板重要标的 ===
            '688008.SH': '澜起科技',
            '688099.SH': '晶晨股份',
            '688036.SH': '传音控股',
            '688111.SH': '金山办公',
            '688981.SH': '中芯国际',
            '688519.SH': '南微医学',
            '688363.SH': '华熙生物',
            '688388.SH': '嘉元科技',
            '688169.SH': '石头科技',
            '688200.SH': '华峰测控',
            '688777.SH': '中控技术',
            '688561.SH': '奇安信-U',
            '688696.SH': '极米科技',
            '688005.SH': '容百科技',
            '688122.SH': '西部超导',
            
            # === 创业板重要标的 ===
            '300750.SZ': '宁德时代',
            '300760.SZ': '迈瑞医疗',
            '300015.SZ': '爱尔眼科',
            '300142.SZ': '沃森生物',
            '300347.SZ': '泰格医药',
            '300601.SZ': '康泰生物',
            '300274.SZ': '阳光电源',
            '300763.SZ': '锦浪科技',
            '300014.SZ': '亿纬锂能',
            '300450.SZ': '先导智能',
            '300073.SZ': '当升科技',
            '300033.SZ': '同花顺',
            '300454.SZ': '深信服',
            '300253.SZ': '卫宁健康',
            '300017.SZ': '网宿科技'
        }
    
    def _init_industry_mapping(self) -> Dict[str, List[str]]:
        """初始化行业股票映射"""
        return {
            '石油化工': [
                '601857.SH', '600028.SH', '600688.SH', '600871.SH', 
                '002493.SZ', '000703.SZ', '000059.SZ', '600346.SH'
            ],
            '银行': [
                '601398.SH', '601988.SH', '601939.SH', '601288.SH',
                '600036.SH', '000001.SZ', '600000.SH', '601328.SH'
            ],
            '保险证券': [
                '601318.SH', '601601.SH', '601628.SH', '000776.SZ',
                '600030.SH', '000166.SZ', '600837.SH', '600958.SH'
            ],
            '白酒': [
                '600519.SH', '000858.SZ', '000568.SZ', '002304.SZ',
                '000596.SZ', '603589.SH', '000799.SZ', '600779.SH'
            ],
            '房地产': [
                '000002.SZ', '001979.SZ', '600048.SH', '000069.SZ',
                '600340.SH', '600383.SH', '001289.SZ', '600266.SH'
            ],
            '钢铁有色': [
                '600019.SH', '000709.SZ', '600581.SH', '000932.SZ',
                '600362.SH', '002460.SZ', '002466.SZ', '000831.SZ'
            ],
            '煤炭电力': [
                '601088.SH', '600188.SH', '601001.SH', '600348.SH',
                '600886.SH', '000875.SZ', '600027.SH', '600795.SH'
            ],
            '科技': [
                '000063.SZ', '002415.SZ', '300059.SZ', '002230.SZ',
                '000725.SZ', '002241.SZ', '300750.SZ', '000938.SZ'
            ],
            '新能源汽车': [
                '002594.SZ', '600104.SH', '000625.SZ', '601238.SH',
                '002129.SZ', '601012.SH', '300274.SZ', '002459.SZ'
            ],
            '医药生物': [
                '000661.SZ', '600276.SH', '300015.SZ', '000423.SZ',
                '603259.SH', '300347.SZ', '300760.SZ', '600521.SH'
            ],
            '消费': [
                '000895.SZ', '002032.SZ', '600887.SH', '002568.SZ',
                '603288.SH', '000333.SZ', '000651.SZ', '600298.SH'
            ],
            '交通运输': [
                '600029.SH', '600115.SH', '601111.SH', '600026.SH',
                '601919.SH', '600428.SH', '000089.SZ', '600004.SH'
            ],
            '建筑材料': [
                '600585.SH', '000877.SZ', '600801.SH', '002233.SZ',
                '600720.SH', '000401.SZ', '000789.SZ', '000786.SZ'
            ],
            '通信': [
                '600050.SH', '000063.SZ', '600776.SH', '002017.SZ',
                '000070.SZ', '600498.SH', '002396.SZ', '002281.SZ'
            ],
            '军工航天': [
                '000768.SZ', '600893.SH', '002013.SZ', '000738.SZ',
                '002151.SZ', '002465.SZ', '000901.SZ', '600879.SH'
            ],
            '央企国企': [
                '601390.SH', '601186.SH', '601800.SH', '601668.SH',
                '600068.SH', '600583.SH', '601808.SH', '000983.SZ'
            ]
        }
    
    def get_all_stocks(self) -> Dict[str, str]:
        """获取所有股票"""
        return self.comprehensive_mapping.copy()
    
    def get_stocks_by_industry(self, industry: str) -> List[str]:
        """根据行业获取股票列表"""
        return self.industry_mapping.get(industry, [])
    
    def get_industry_list(self) -> List[str]:
        """获取所有行业列表"""
        return list(self.industry_mapping.keys())
    
    def search_stocks(self, query: str, limit: int = 20) -> List[Dict[str, str]]:
        """搜索股票"""
        query_upper = query.upper().strip()
        query_original = query.strip()
        results = []
        
        # 特殊搜索映射
        search_aliases = {
            '中石油': '中国石油',
            '中石化': '中国石化', 
            '工行': '工商银行',
            '建行': '建设银行',
            '中行': '中国银行',
            '农行': '农业银行',
            '招行': '招商银行',
            '茅台': '贵州茅台',
            '五粮': '五粮液',
            '平安': '中国平安',
            '万科': '万科A',
            '比亚迪': '比亚迪',
            '宁德': '宁德时代',
            '中兴': '中兴通讯'
        }
        
        # 检查别名
        search_term = query_original
        for alias, full_name in search_aliases.items():
            if alias in query_original:
                search_term = full_name
                break
        
        for symbol, name in self.comprehensive_mapping.items():
            match_score = 0
            match_type = 'none'
            
            # 精确代码匹配
            if query_upper == symbol.upper():
                match_score = 100
                match_type = 'exact_code'
            # 代码包含匹配
            elif query_upper in symbol.upper():
                match_score = 90
                match_type = 'code'
            # 精确名称匹配
            elif search_term == name:
                match_score = 85
                match_type = 'exact_name'
            # 名称包含匹配
            elif search_term in name or query_original in name:
                match_score = 80
                match_type = 'name'
            # 模糊匹配
            elif any(word in name for word in search_term.split() if len(word) > 1):
                match_score = 70
                match_type = 'fuzzy'
            
            if match_score > 0:
                results.append({
                    'symbol': symbol,
                    'name': name,
                    'match_type': match_type,
                    'score': match_score
                })
        
        # 按分数排序
        results.sort(key=lambda x: (-x['score'], x['symbol']))
        
        return results[:limit]
    
    def get_stock_name(self, symbol: str) -> str:
        """获取股票名称"""
        return self.comprehensive_mapping.get(symbol.upper(), symbol)
    
    def get_random_stocks(self, count: int = 50) -> List[str]:
        """获取随机股票样本"""
        import random
        all_stocks = list(self.comprehensive_mapping.keys())
        return random.sample(all_stocks, min(count, len(all_stocks)))
    
    def get_blue_chip_stocks(self) -> List[str]:
        """获取蓝筹股列表"""
        blue_chips = [
            # 银行股
            '601398.SH', '601988.SH', '601939.SH', '601288.SH', '600036.SH',
            # 石油化工
            '601857.SH', '600028.SH',
            # 保险
            '601318.SH', '601601.SH', '601628.SH',
            # 白酒
            '600519.SH', '000858.SZ', '000568.SZ',
            # 科技
            '000063.SZ', '002415.SZ', '300750.SZ',
            # 消费
            '000333.SZ', '000651.SZ', '600887.SH',
            # 医药
            '000661.SZ', '600276.SH', '300760.SZ',
            # 新能源
            '002594.SZ', '601012.SH', '300274.SZ',
            # 建筑央企
            '601668.SH', '601390.SH', '601800.SH',
            # 交通运输
            '600029.SH', '600115.SH', '601111.SH'
        ]
        return blue_chips

# 全局实例
comprehensive_stock_pool = ComprehensiveStockPool()
